<script>

var user = document.querySelector("#userid").textContent;
var tttGame = createTttGame(user, document.querySelector("#game-div"), onGameEnded);

/**
 * Run initializations on page load.
 */
window.onload = function() {
    initializeButtons();
};

window.onbeforeunload = function () {
    return "Are you sure you want to leave?";
};

function initializeButtons() {
    getPlayButton().addEventListener("click", onPlayClicked);

    const quitButton = getQuitButton();
    quitButton.disabled = true;
    quitButton.addEventListener("click", onQuitClicked);
}

function onPlayClicked() {
    playButtonSound();
    tttGame.enterGame();
    toggleButtons();
}

function onQuitClicked() {
    playButtonSound();
    tttGame.playerQuits();
}

function toggleButtons() {
    var playButton = getPlayButton();
    var quitButton = getQuitButton();
    // console.log("togging buttons. quit disabled = " + quitButton.disabled);
    playButton.disabled = !playButton.disabled;
    quitButton.disabled = !quitButton.disabled;
}

function onGameEnded(gameId) {
    toggleButtons();
}

function getPlayButton() {
    return document.querySelector("#play");
}

function getQuitButton() {
    return document.querySelector("#quit");
}

function playButtonSound() {
    var sound = document.getElementById("audio-button");
    sound.play();
}

</script>
